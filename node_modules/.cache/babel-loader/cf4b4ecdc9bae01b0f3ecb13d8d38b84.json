{"ast":null,"code":"var _jsxFileName = \"/home/isaac/git/react_stuff/blog-redux-router-styling/src/App.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect } from 'react';\nimport Blog from './components/Blog';\nimport LoginForm from './components/LoginForm.js';\nimport PostForm from './components/PostForm.js';\nimport Togglable from './components/Togglable.js';\nimport GoodNotif from './components/GoodNotif.js';\nimport blogService from './services/blogs';\nimport loginService from './services/login.js';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { setNotif, clearNotif } from './reducers/notifReducer.js';\nimport { setUser } from './reducers/userReducer.js';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst App = () => {\n  _s();\n\n  const [blogs, setBlogs] = useState([]);\n  const [successMsg, setSuccessMsg] = useState(null);\n  const [errMsg, setErrMsg] = useState(null);\n  const dispatch = useDispatch();\n  useEffect(() => {\n    blogService.getAll().then(blogs => setBlogs(blogs.sort((a, b) => {\n      return b.likes - a.likes;\n    })));\n  }, []);\n  useEffect(() => {\n    const loggedUserJSON = window.localStorage.getItem('loggedBlogappUser');\n\n    if (loggedUserJSON) {\n      const user = JSON.parse(loggedUserJSON);\n      dispatch(setUser(user));\n      blogService.setToken(user.token);\n    }\n  }, []);\n  /*\n  const handleLogin = async (event) => {\n      event.preventDefault()\n      try{\n          const user = await loginService.login({\n              username, password\n          })\n          window.localStorage.setItem('loggedBlogappUser', JSON.stringify(user))\n          blogService.setToken(user.token)\n          setUser(user)\n          setSuccessMsg(\"Logged in successfully\")\n          setTimeout(()=> {\n              setSuccessMsg(null)\n          },3000)\n          setUsername('')\n          setPassword('')\n      }\n      catch (exception) {\n          //setErrMsg('Wront credentials')\n          dispatch(setNotif(\"wrong credentials\"))\n          setTimeout(() => {\n              //setErrMsg(null)\n              dispatch(clearNotif())\n          },4000)\n      }\n  }*/\n\n  const addPost = postObject => {\n    blogService.create(postObject).then(returnedPost => {\n      setBlogs(blogs.concat(returnedPost));\n    });\n    setSuccessMsg(\"post added\");\n    setTimeout(() => {\n      setSuccessMsg(null);\n    }, 3000);\n  };\n\n  const updateLikes = blog => {\n    const updatedBlog = {\n      user: blog.user.id,\n      author: blog.author,\n      title: blog.title,\n      url: blog.url,\n      likes: blog.likes\n    };\n    const updatedBlogId = blog.id;\n    blogService.update(blog.id, updatedBlog).then(returnedPost => {\n      setBlogs(blogs.map(blog => blog.id !== updatedBlogId ? blog : returnedPost));\n    });\n    setBlogs(blogs.sort((a, b) => {\n      return b.likes - a.likes;\n    }));\n  };\n\n  const handleDel = id => {\n    const maybe = window.confirm(\"do you really want to delete?\");\n    if (!maybe) return;\n    const toDel = blogs.find(blog => blog.id === id);\n    blogService.del(id).then(persontoDel => {\n      setBlogs(blogs.filter(blog => blog.id !== toDel.id));\n    });\n    setBlogs(blogs.sort((a, b) => {\n      return b.likes - a.likes;\n    }));\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"blogs\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(GoodNotif, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 7\n    }, this), user === null ? /*#__PURE__*/_jsxDEV(Togglable, {\n      buttonLabel: \"login\",\n      children: /*#__PURE__*/_jsxDEV(LoginForm, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: [user.name, \" logged in\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: window.localStorage.clear(),\n        children: \"logout\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(Togglable, {\n        buttonLabel: \"new post\",\n        children: /*#__PURE__*/_jsxDEV(PostForm, {\n          createPost: addPost\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 13\n      }, this), blogs.map(blog => /*#__PURE__*/_jsxDEV(Blog, {\n        blog: blog,\n        handleLikes: () => updateLikes(blog),\n        handleDel: () => handleDel(blog.id)\n      }, blog.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 13\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 8\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 100,\n    columnNumber: 5\n  }, this);\n};\n\n_s(App, \"kGlyHx606+/U+3a5pkLvgPXZ4EI=\", false, function () {\n  return [useDispatch];\n});\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["/home/isaac/git/react_stuff/blog-redux-router-styling/src/App.js"],"names":["useState","useEffect","Blog","LoginForm","PostForm","Togglable","GoodNotif","blogService","loginService","useDispatch","useSelector","setNotif","clearNotif","setUser","App","blogs","setBlogs","successMsg","setSuccessMsg","errMsg","setErrMsg","dispatch","getAll","then","sort","a","b","likes","loggedUserJSON","window","localStorage","getItem","user","JSON","parse","setToken","token","addPost","postObject","create","returnedPost","concat","setTimeout","updateLikes","blog","updatedBlog","id","author","title","url","updatedBlogId","update","map","handleDel","maybe","confirm","toDel","find","del","persontoDel","filter","name","clear"],"mappings":"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","sourcesContent":["import { useState, useEffect } from 'react'\nimport Blog from './components/Blog'\nimport LoginForm from './components/LoginForm.js'\nimport PostForm from './components/PostForm.js'\nimport Togglable from './components/Togglable.js'\nimport GoodNotif from './components/GoodNotif.js'\nimport blogService from './services/blogs'\nimport loginService from './services/login.js'\nimport { useDispatch, useSelector } from 'react-redux'\nimport {setNotif, clearNotif} from './reducers/notifReducer.js'\nimport {setUser} from './reducers/userReducer.js'\n\nconst App = () => {\n    const [blogs, setBlogs] = useState([])\n    const [successMsg, setSuccessMsg] = useState(null)\n    const [errMsg, setErrMsg] = useState(null)\n    const dispatch = useDispatch()\n\n  useEffect(() => {\n    blogService.getAll().then(blogs =>\n      setBlogs( blogs.sort((a,b) => {return b.likes - a.likes}))\n    )  \n  }, [])\n    useEffect(() => {\n        const loggedUserJSON = window.localStorage.getItem('loggedBlogappUser')\n        if(loggedUserJSON){\n            const user = JSON.parse(loggedUserJSON)\n            dispatch(setUser(user))\n            blogService.setToken(user.token)\n        }\n    }, [])\n    /*\n    const handleLogin = async (event) => {\n        event.preventDefault()\n        try{\n            const user = await loginService.login({\n                username, password\n            })\n            window.localStorage.setItem('loggedBlogappUser', JSON.stringify(user))\n            blogService.setToken(user.token)\n            setUser(user)\n            setSuccessMsg(\"Logged in successfully\")\n            setTimeout(()=> {\n                setSuccessMsg(null)\n            },3000)\n            setUsername('')\n            setPassword('')\n        }\n        catch (exception) {\n            //setErrMsg('Wront credentials')\n            dispatch(setNotif(\"wrong credentials\"))\n            setTimeout(() => {\n                //setErrMsg(null)\n                dispatch(clearNotif())\n            },4000)\n        }\n    }*/\n    const addPost = postObject => {\n        blogService\n            .create(postObject)\n            .then(returnedPost => {\n                setBlogs(blogs.concat(returnedPost))\n            })\n       setSuccessMsg(\"post added\") \n        setTimeout(()=> {\n            setSuccessMsg(null)\n        },3000)\n    }\n\n    const updateLikes = (blog) => {\n        const updatedBlog = {\n            user: blog.user.id,\n            author: blog.author,\n            title: blog.title,\n            url: blog.url,\n            likes: blog.likes\n        }\n        const updatedBlogId = blog.id\n        blogService\n            .update(blog.id, updatedBlog)\n            .then(returnedPost => {\n                setBlogs(blogs.map(blog => blog.id !== updatedBlogId ? blog : returnedPost))   \n            })\n        setBlogs(blogs.sort((a,b) => {return b.likes - a.likes}))\n    }\n    const handleDel = id => {\n        const maybe = window.confirm(\"do you really want to delete?\")\n        if(!maybe)\n            return\n        const toDel = blogs.find(blog => blog.id === id)\n        blogService\n            .del(id)\n            .then(persontoDel => {\n                setBlogs(blogs.filter(blog => blog.id !== toDel.id))\n            }) \n        \n        setBlogs(blogs.sort((a,b) => {return b.likes - a.likes}))\n    }\n  return (\n    <div>\n      <h2>blogs</h2>\n      <GoodNotif />\n      {user === null ?\n        <Togglable buttonLabel='login'>\n          <LoginForm/>\n        </Togglable> :\n       <div>\n            <p>{user.name} logged in</p>\n            <button onClick={window.localStorage.clear() } >logout</button>\n            <Togglable buttonLabel=\"new post\">\n                <PostForm createPost={addPost}/>\n            </Togglable>\n            {blogs.map(blog =>\n            <Blog key={blog.id} blog={blog} handleLikes={()=> updateLikes(blog)} handleDel={()=> handleDel(blog.id)} />)}\n        </div>\n      }\n    </div>\n  )\n}\n\nexport default App\n"]},"metadata":{},"sourceType":"module"}